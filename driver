#!/usr/bin/python3

import psycopg2
import sqlalchemy 

from sqlalchemy import create_engine
from sqlalchemy import text 

def get_engine():

    # dialect[+driver]://user:password@host/dbname[?key=value..]
    engine = create_engine("postgresql+psycopg2://admin:p0stdev@127.0.0.1:5432", echo=True)
    return engine

e = get_engine()

with e.connect() as conn:
    try:
        conn.execute(text("CREATE TABLE some_table (x int, y int)"))
    except sqlalchemy.exc.ProgrammingError as e:
        print(e)
    conn.execute(
        text("INSERT INTO some_table (x, y) VALUES (:x, :y)"),
    [{"x": 1, "y": 1}, {"x":2,"y":4}],
    )
    conn.commit()


#breakpoint()
